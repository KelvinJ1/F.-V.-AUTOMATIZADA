LIST    P=16F84A,    ; usar PIC 16F84A
#include <p16f84A.inc>

 __CONFIG _CP_OFF & _WDT_OFF & _PWRTE_ON & _XT_OSC
  

X equ 0C
Y equ 0D
;DCounter1 EQU 0X0C
;DCounter2 EQU 0X0D
;DCounter3 EQU 0X0E
PORTA    EQU    05
PORTB    EQU    06
 
ORG        0
BSF        STATUS,5   ;Paso al banco 1
MOVLW      B'11111111'    ; Defino puerto b como entrada
MOVWF      TRISB
MOVLW	   B'00000'	;Defino puerto a como salida
MOVWF	   TRISA
BCF        STATUS,5    ; Paso al banco 0

BTN_INICIO ; etiqueta
	CLRF PORTA
	BTFSS PORTB,0
	GOTO BTN_INICIO
	GOTO CHK_S1

BTN_CHECK ; etiqueta
	CLRF PORTA
	BTFSS PORTB,0
	GOTO BTN_CHECK
	RETURN
	GOTO CHK_S1

	
BTN_STOP
	BTFSS PORTB,1
	RETURN
	GOTO STOP_PT2


CHK_S1
	CALL BTN_CHECK
	CALL BTN_STOP
	BTFSS PORTB,2
	GOTO CHK_S1
	MOVLW B'00001'
	MOVWF PORTA
	BTFSS PORTB,3
	GOTO CHK_S1
	GOTO CHK_S2
	
	
	
CHK_S2 
	CALL S2_CYCLE
	CALL S2_CYCLE
	MOVLW B'00001'
	MOVWF PORTA
	BTFSS PORTB,4
	GOTO CHK_S2
	GOTO CHK_S3 
	
S2_CYCLE
	MOVLW B'00010' ;RETORCESO
	MOVWF PORTA
	CALL DEMORA
	MOVLW B'00001' ;AVANCE
	MOVWF PORTA
	CALL DEMORA
RETURN



CHK_S3
	CALL S3_CYCLE
	CALL S3_CYCLE
	CALL S3_CYCLE


S3_CYCLE
	MOVLW B'00110' ;RETORCESO
	MOVWF PORTA

	CALL DEMORA
	MOVLW B'00101' ;AVANCE
	MOVWF PORTA

	CALL DEMORA	
	GOTO CHK_S4
RETURN

CHK_S4
	BTFSS PORTB,5
	GOTO CHK_S4
	MOVLW B'00001' ;AVANCE
	MOVWF PORTA
	CALL BTN_STOP
	CALL DEMORA
	MOVLW B'00000' ;AVANCE
	MOVWF PORTA
	GOTO BTN_INICIO	
	

STOP_PT2
	MOVLW B'00001'
	MOVWF PORTA
	BTFSS PORTB,5
	GOTO STOP_PT2
	GOTO BTN_INICIO
;__________________________________



DEMORA movlw 5000
movwf X
PLoop1 movlw 5000
movwf Y
PLoop2 clrwdt
clrwdt
decfsz Y,1
goto PLoop2
decfsz X,1
goto PLoop1
PDelL1 goto PDelL2
PDelL2
return



END

			
	